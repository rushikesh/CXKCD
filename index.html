<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Rushikesh: XKCD viewer App</title>
	<link rel="stylesheet" href="themes/xkcd.min.css" />
	<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="themes/jquery.mobile.structure-1.4.2.min.css" />
	<script src="themes/jquery-1.10.2.min.js"></script>
	<script src="themes/jquery.mobile-1.4.2.min.js"></script>
	<style type="text/css">
		#content{
			margin: 0 auto;
			text-align: center;
		}
		#descComic{
			text-overflow: ellipsis;
			overflow: hidden;
			white-space: nowrap;
		}
	</style>
	<script type="text/javascript">
		var html,title,prev,next,comicTitle;
		$(document).ready(function() {

			//putFooterToBottom();
			loadXkcdData("");
			$('#descComic').on('click',function(){
				var tmp = "<center><b>"+comicTitle +":</b></center><br/>" + title ;
				$('#comicSpan').html(tmp);
			});

			$('#prevComic').on('click',function(){
				loadXkcdData (prev);
			});

			$('#nextComic').on('click',function(){
				loadXkcdData (next);
			});
		});

		function loadXkcdData (comicId) {
			var url = "https://www.xkcd.com"+comicId;
			var jqxhr = $.get( url, function( data ) {
				//$( ".result" ).html( data );
				html = $(data);
				var tmp = html.find('#comic').html();
				//console.dir(tmp);
				$('#content').html(tmp);
				title = $(tmp).attr('title');
				prev = html.find('a[rel=prev]').attr('href');
				next = html.find('a[rel=next]').attr('href');
				comicTitle = $(tmp).attr('alt');
				$('#titleComic').html("XKCD:"+comicTitle);
				
			}).fail(function() {
			    alert( "Cannot Connect: Check Your Network/Wi-fi Connection" );
			});
		}
		function putFooterToBottom () {
			var docHeight = $(window).height();
			var footerHeight = $('#footer').height();
			var footerTop = $('#footer').position().top + footerHeight;

			if (footerTop < docHeight) {
				$('#footer').css('margin-top', (docHeight - footerTop) + 'px');
			}
		}

	</script>
</head>
<body>
	<div data-role="page" data-theme="a">
		<div data-role="header" data-position="fixed" data-fullscreen="false">
			<h1 id="titleComic">XKCD</h1>
			<a href="#popupBasic" data-position-to="window" data-transition="fade" data-rel="popup" id="infoicon" data-icon="info" class="ui-btn-right" data-iconpos="notext">Info</a>
		</div>
		<div id="content" data-role="content" data-theme="a">
			
		</div>
		<div id="footer" data-role="footer" data-position="fixed" data-fullscreen="true" data-theme="b">
			<div data-role="navbar" style="width:98%;float:left">
					<ul>
						<li><a href="#" id="prevComic">Prev</a></li>
						<li><a href="#popupComicInfo" data-position-to="window" data-transition="fade" data-rel="popup" id="descComic">Comic Info</a></li>
						<li><a href="#" id="nextComic">Next</a></li>
					</ul>
			</div>		
<!-- 			<a href="#" id="descComic" data-icon="info" class="ui-btn-center" data-iconpos="notext">Info</a>
<a href="#" id="prevComic" data-icon="arrow-l" class="ui-btn-left" data-iconpos="notext">Prev</a>
<a href="#" id="nextComic" data-icon="arrow-r" class="ui-btn-right" data-iconpos="notext">Next</a> -->
		</div> 
		<div data-role="popup" id="popupBasic" data-overlay-theme="a" class="ui-content" >
	    	<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
				<p>XKCD Comic Viewer.<p>
				<p>Created By: <a href="http://www.rushis.com">Rushi</a><p>
		</div>
		<div data-role="popup" id="popupComicInfo" data-overlay-theme="a" class="ui-content" >
	    	<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
				<span id="comicSpan"></span>
		</div>		
	</div>
</body>
</html>